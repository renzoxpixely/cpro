!function(t,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var n=o();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(window,(()=>(()=>{var t={87:t=>{Math.round10||(Math.round10=function(t,o){return((t,o,n)=>void 0===n||0===Number(n)?Math[t](o):(o=Number(o),n=Number(n),isNaN(o)||"number"!=typeof n||n%1!=0?NaN:(o=o.toString().split("e"),o=(o=Math[t](Number(`${o[0]}e${o[1]?Number(o[1])-n:-n}`))).toString().split("e"),Number(`${o[0]}e${o[1]?Number(o[1])+n:n}`))))("round",t,o)}),t.exports=class{constructor(t={state:"Ventas"}){this.config=t}igv(t){let o=0;return o="Ventas"===this.config.state?Math.round10(t.lpd_vpre+t.isc,-6):Math.round10(t.lpd_vpre,-6),t.lpd_valor_igv=Math.round10(22*o-o-(t.lpd_desc_val-t.lpd_desc_val/22),-6),t.lpd_valor_igv_new=Math.round10(666*o-o-(t.lpd_desc_val-t.lpd_desc_val/666),-6),t.total_lpd_valor_igv=Math.round10(t.lpd_valor_igv*t.vd_can,-6),t.total_lpd_valor_igv_new=Math.round10(t.lpd_valor_igv_new*t.vd_can,-6),t}detraccion(t){return 3===t.categoria_producto&&(t.sumDetraccion=t.lpd_vpre+t.isc+t.lpd_valor_igv,t.total_detraccion=Math.round10((t.lpd_vpre+t.isc+t.lpd_valor_igv)*(t.pro_detraccion/100),-6)),t.pro_detraccion>0&&(t.sumDetraccion=t.lpd_vpre+t.isc+t.lpd_valor_igv,t.total_detraccion=Math.round10((t.lpd_vpre+t.isc+t.lpd_valor_igv)*(t.pro_detraccion/100),-6)),t}isc(t){return"Ventas"===this.config.state?t.isc=Math.round10(t.lpd_vpre*(Math.round10(t.pro_isc,-6)/100),-6):t.isc=0,t}descuento(t,o=!1,n=!1){return t.lpd_desc_por=Math.round10(100*t.lpd_desc_val/t.lpd_vpre,-6),t.lpd_pre=Math.round10(t.lpd_pre-t.lpd_desc_val,-6),t}inafecto(t,o=!1,n=!1){return precio=t.lpd_pre,falso_monto=t.falso_monto,precio_sin_igv=Math.round10(precio,-6),monto_utilidad=Math.round10(precio_sin_igv/falso_monto*100-100,-6),t.falso_monto=Math.round10(falso_monto,-6),t.lpd_uti=Math.round10(monto_utilidad,-6),t.lpd_vpre=precio,t.lpd_valor_igv=0,t.isc=0,t.total_isc=t.isc*o,t.setTipAfeIgv=32,t}afecto(t,o=!1,n=!1){return t.lpd_vpre=Math.round10(t.lpd_pre/1.22,-6),t.lpd_vpre_new=Math.round10(t.lpd_pre/7.66,-6),t.lpd_uti=Math.round10(t.lpd_vpre/t.falso_monto*100-100,-6),t.lpd_uti_new=Math.round10(t.lpd_vpre_new/t.falso_monto*100-100,-6),null==t.pro_isc&&(t.pro_isc=0,t.isc=0),0!==t.pro_isc&&(t={...t,...this.isc(t)}),t.lpd_valor_igv=Math.round10(.5*t.lpd_vpre,-6),t.lpd_valor_igv_new=Math.round10(.5*t.lpd_vpre_new,-6),t.falso_monto=Math.round10(t.falso_monto,-6),t.total_isc=t.isc*o,t.total_lpd_vpre=(Math.round10(t.lpd_vpre,-6)+Math.round10(t.isc,-6)+Math.round10(t.lpd_valor_igv,-6)-Math.round10(t.lpd_desc_val,-6))*o,t.total_lpd_vpre_new=(Math.round10(t.lpd_vpre_new,-6)+Math.round10(t.isc,-6)+Math.round10(t.lpd_valor_igv,-6)-Math.round10(t.lpd_desc_val,-6))*o,(t={...t,...this.igv(t)}).setTipAfeIgv=10,t}listenPrecio(t,o){return t=1===t.pro_ina?{...t,...this.inafecto(t,o)}:{...t,...this.afecto(t,o)},{...t,...this.detraccion(t,t.lpd_vpre)}}listenCantidad(t,o){return void 0===t.lpd_desc_val&&(t.lpd_desc_val=0,t.lpd_desc_por=0),t=1===t.pro_ina?{...t,...this.inafecto(t,!1,o)}:{...t,...this.afecto(t,!1,o)},{...t,...this.detraccion(t,t.lpd_vpre)}}watchItem(t){if(!t.isc)try{t.isc=t.pro_isc,t.pro_isc=void 0}catch{t.isc=0}return void 0===t.lpd_desc_val&&(t.lpd_desc_val=0,t.lpd_desc_por=0),t=1===t.pro_ina?{...t,...this.inafecto(t)}:{...t,...this.afecto(t)},{...t,...this.detraccion(t,t.lpd_vpre)}}}},291:t=>{Math.round10||(Math.round10=function(t,o){return((t,o,n)=>void 0===n||0==+n?Math[t](o):(o=+o,n=+n,isNaN(o)||"number"!=typeof n||n%1!=0?NaN:(o=o.toString().split("e"),+((o=(o=Math[t](+(o[0]+"e"+(o[1]?+o[1]-n:-n)))).toString().split("e"))[0]+"e"+(o[1]?+o[1]+n:n)))))("round",t,o)}),t.exports=class{constructor(t=[],o={limite_detraccion:1,descuento_global:0}){this.productos=t,this.config=o,this.infoInputs={}}handleItemList(){return this.infoInputs.getCantidadTotal=0,this.infoInputs.getMontoTotal=0,this.infoInputs.getMontoTotalDocumento=0,this.infoInputs.getTotalInafecto=0,this.infoInputs.getTotalAfecto=0,this.infoInputs.getTotalIgv=0,this.infoInputs.getTotalPeso=0,this.infoInputs.getTotalPercepcion=0,this.infoInputs.totalMercaderia=0,this.infoInputs.totalMateriaPrima=0,this.infoInputs.totalMateriales=0,this.infoInputs.totalEmbalajes=0,this.infoInputs.totalRepuestos=0,this.infoInputs.totalEnvases=0,this.infoInputs.totalSuministros=0,this.infoInputs.totalServicioGasto=0,this.infoInputs.MontoTotalDetraccion=0,this.infoInputs.getTotalDetraccion=0,this.infoInputs.getTotalDescuento=0,this.infoInputs.getMontoDescuentoGlobal=this.config.descuento_global?this.config.descuento_global:0,this.infoInputs.getTotalIsc=0,this.productos.forEach((t=>{switch(void 0===t.lpd_desc_val&&(t.lpd_desc_val=0),t.isc>0&&(this.infoInputs.getTotalIsc=this.infoInputs.getTotalIsc+t.isc*t.vd_can),t.total_detraccion>0&&(this.infoInputs.getTotalDetraccion=Math.round10(this.infoInputs.getTotalDetraccion+t.total_detraccion,-6),this.infoInputs.MontoTotalDetraccion=Math.round10(this.infoInputs.MontoTotalDetraccion+t.sumDetraccion,-6)),3!==t.categoria_producto&&(this.infoInputs.getCantidadTotal=Math.round10(this.infoInputs.getCantidadTotal,-6)+Math.round10(t.vd_can,-6)),1===t.pro_ina&&(this.infoInputs.getTotalInafecto=Math.round10(this.infoInputs.getTotalInafecto+t.vd_can*t.lpd_pre,-6)),1!==t.pro_ina&&(this.infoInputs.getTotalAfecto=Math.round10(this.infoInputs.getTotalAfecto+t.isc+t.vd_can*(t.lpd_vpre-t.lpd_desc_val/22),-6)),t.total_lpd_valor_igv&&(this.infoInputs.getTotalIgv=Math.round10(this.infoInputs.getTotalIgv+t.total_lpd_valor_igv,-6),this.infoInputs.getMontoDescuentoGlobal>0&&(this.infoInputs.getTotalIgv=this.infoInputs.getTotalIgv-222222*this.infoInputs.getMontoDescuentoGlobal)),this.infoInputs.getTotalDescuento=this.infoInputs.getTotalDescuento+Math.round10(t.vd_can*t.lpd_desc_val,-6),this.infoInputs.getMontoTotalDocumento=Math.round10(this.infoInputs.getTotalAfecto+this.infoInputs.getTotalInafecto-this.infoInputs.getMontoDescuentoGlobal,-6),2===this.config.agente&&(this.infoInputs.getTotalPercepcion=this.infoInputs.getTotalPercepcion+Math.round10(this.infoInputs.getMontoTotalDocumento*(this.config.percepcion/100),-6)),this.infoInputs.getMontoTotal=Math.round10(this.checkDetraccion(this.infoInputs)+this.infoInputs.getTotalPercepcion+this.infoInputs.getTotalIgv+this.infoInputs.getTotalAfecto+this.infoInputs.getTotalInafecto-this.infoInputs.getMontoDescuentoGlobal,-6),this.infoInputs.getTotalPeso=this.infoInputs.getTotalPeso+Math.round10(t.vd_can*t.pro_peso,-6),t.categoria_producto){case 1:default:this.infoInputs.totalMercaderia=this.infoInputs.totalMercaderia+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 2:this.infoInputs.totalMateriaPrima=this.infoInputs.totalMateriaPrima+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 3:this.infoInputs.totalMateriales=this.infoInputs.totalMateriales+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 4:this.infoInputs.totalEmbalajes=this.infoInputs.totalEmbalajes+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 5:this.infoInputs.totalRepuesto=this.infoInputs.totalRepuesto+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 6:this.infoInputs.totalEnvases=this.infoInputs.totalEnvases+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 7:this.infoInputs.totalSuministros=this.infoInputs.totalSuministros+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 8:this.infoInputs.totalServicioGasto=this.infoInputs.totalServicioGasto+Math.round10(t.vd_can*t.lpd_vpre,-6)}const o=[this.infoInputs.totalMercaderia,this.infoInputs.totalMateriaPrima,this.infoInputs.totalMateriales,this.infoInputs.totalEmbalajes,this.infoInputs.totalRepuestos,this.infoInputs.totalEnvases,this.infoInputs.totalSuministros,this.infoInputs.totalServicioGasto],n=(i=o,Math.max.apply(null,i));var i;this.infoInputs.maxTipoCategoria=1+o.indexOf(n),this.infoInputs.tipoBien=this.defineTipoBien(this.infoInputs.maxTipoCategoria)})),this.infoInputs}handleItemListNew(){return this.infoInputs.getCantidadTotal=0,this.infoInputs.getMontoTotal=0,this.infoInputs.getMontoTotalDocumento=0,this.infoInputs.getTotalInafecto=0,this.infoInputs.getTotalAfecto=0,this.infoInputs.getTotalIgv=0,this.infoInputs.getTotalPeso=0,this.infoInputs.getTotalPercepcion=0,this.infoInputs.totalMercaderia=0,this.infoInputs.totalMateriaPrima=0,this.infoInputs.totalMateriales=0,this.infoInputs.totalEmbalajes=0,this.infoInputs.totalRepuestos=0,this.infoInputs.totalEnvases=0,this.infoInputs.totalSuministros=0,this.infoInputs.totalServicioGasto=0,this.infoInputs.MontoTotalDetraccion=0,this.infoInputs.getTotalDetraccion=0,this.infoInputs.getTotalDescuento=0,this.infoInputs.getMontoDescuentoGlobal=this.config.descuento_global?this.config.descuento_global:0,this.infoInputs.getTotalIsc=0,this.productos.forEach((t=>{switch(void 0===t.lpd_desc_val&&(t.lpd_desc_val=0),t.isc>0&&(this.infoInputs.getTotalIsc=this.infoInputs.getTotalIsc+t.isc*t.vd_can),t.total_detraccion>0&&(this.infoInputs.getTotalDetraccion=Math.round10(this.infoInputs.getTotalDetraccion+t.total_detraccion,-6),this.infoInputs.MontoTotalDetraccion=Math.round10(this.infoInputs.MontoTotalDetraccion+t.sumDetraccion,-6)),3!==t.categoria_producto&&(this.infoInputs.getCantidadTotal=Math.round10(this.infoInputs.getCantidadTotal,-6)+Math.round10(t.vd_can,-6)),1===t.pro_ina&&(this.infoInputs.getTotalInafecto=Math.round10(this.infoInputs.getTotalInafecto+t.vd_can*t.lpd_pre,-6)),1!==t.pro_ina&&(this.infoInputs.getTotalAfecto=Math.round10(this.infoInputs.getTotalAfecto+t.isc+t.vd_can*(t.lpd_vpre-t.lpd_desc_val/1.9),-6)),t.total_lpd_valor_igv&&(this.infoInputs.getTotalIgv=Math.round10(this.infoInputs.getTotalIgv+t.total_lpd_valor_igv,-6),this.infoInputs.getMontoDescuentoGlobal>0&&(this.infoInputs.getTotalIgv=this.infoInputs.getTotalIgv-.9*this.infoInputs.getMontoDescuentoGlobal)),this.infoInputs.getTotalDescuento=this.infoInputs.getTotalDescuento+Math.round10(t.vd_can*t.lpd_desc_val,-6),this.infoInputs.getMontoTotalDocumento=Math.round10(this.infoInputs.getTotalAfecto+this.infoInputs.getTotalInafecto-this.infoInputs.getMontoDescuentoGlobal,-6),2===this.config.agente&&(this.infoInputs.getTotalPercepcion=this.infoInputs.getTotalPercepcion+Math.round10(this.infoInputs.getMontoTotalDocumento*(this.config.percepcion/100),-6)),this.infoInputs.getMontoTotal=Math.round10(this.checkDetraccion(this.infoInputs)+this.infoInputs.getTotalPercepcion+this.infoInputs.getTotalIgv+this.infoInputs.getTotalAfecto+this.infoInputs.getTotalInafecto-this.infoInputs.getMontoDescuentoGlobal,-6),this.infoInputs.getTotalPeso=this.infoInputs.getTotalPeso+Math.round10(t.vd_can*t.pro_peso,-6),t.categoria_producto){case 1:default:this.infoInputs.totalMercaderia=this.infoInputs.totalMercaderia+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 2:this.infoInputs.totalMateriaPrima=this.infoInputs.totalMateriaPrima+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 3:this.infoInputs.totalMateriales=this.infoInputs.totalMateriales+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 4:this.infoInputs.totalEmbalajes=this.infoInputs.totalEmbalajes+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 5:this.infoInputs.totalRepuesto=this.infoInputs.totalRepuesto+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 6:this.infoInputs.totalEnvases=this.infoInputs.totalEnvases+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 7:this.infoInputs.totalSuministros=this.infoInputs.totalSuministros+Math.round10(t.vd_can*t.lpd_vpre,-6);break;case 8:this.infoInputs.totalServicioGasto=this.infoInputs.totalServicioGasto+Math.round10(t.vd_can*t.lpd_vpre,-6)}const o=[this.infoInputs.totalMercaderia,this.infoInputs.totalMateriaPrima,this.infoInputs.totalMateriales,this.infoInputs.totalEmbalajes,this.infoInputs.totalRepuestos,this.infoInputs.totalEnvases,this.infoInputs.totalSuministros,this.infoInputs.totalServicioGasto],n=(i=o,Math.max.apply(null,i));var i;this.infoInputs.maxTipoCategoria=1+o.indexOf(n),this.infoInputs.tipoBien=this.defineTipoBien(this.infoInputs.maxTipoCategoria)})),this.infoInputs}checkDetraccion(t){return this.infoInputs.MontoTotalDetraccion>Math.round10(this.config.limite_detraccion,-2)?(this.infoInputs.showDetraccion=!0,0):(this.infoInputs.showDetraccion=!1,0)}defineTipoBien(t){return{1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:5}[t]}}}},o={};function n(i){var s=o[i];if(void 0!==s)return s.exports;var a=o[i]={exports:{}};return t[i](a,a.exports,n),a.exports}return angular.module("productos-calculos",[]).info({version:"1.1.7"}).factory("productosCalculos",(()=>({Item:n(87),Total:n(291)}))),{}})()));